# Form Text With Value Substitution From Attributes
Формировать текста с подстановкой значений из атрибутов

ИсточникСсылка - Ссылка на какой либо объект.
Функция "ФормироватьТекстПисьма(ИсточникСсылка) Экспорт" позволяет формировать текст (например письма) с подстановкой значений реквизитов из "ИсточникСсылка"

Через словари выбираеться текст для соответствующих типов объектов
![image](https://user-images.githubusercontent.com/28355711/226540325-581a77b0-602e-466e-a587-b55c9f7b25bc.png)

![image](https://user-images.githubusercontent.com/28355711/226540385-3e87edd8-ac64-4ad5-90ee-6f57ba2d7ecf.png)

Текст с параметрами которые будут заменяться на знч реквизитов
![image](https://user-images.githubusercontent.com/28355711/226540456-03d25929-0050-4760-a2a2-b3adee36b27b.png)

Как мы видим каждому типу документов соответствует свой текст, в любой части текста можно вставлять имя реквизита (существующего у "ИсточникСсылка") как "параметр текста"
ВАЖНО: "параметр текста" должен начинаться "&" и завершаться стоп символом (например стоп символа - "*"), составные пишуться через точку (поддерживаеться один уровень вложенности!). 

1. %1 - Это стопСимвол который устанавливается через СтрШаблон
2. Пример "&Номер%1" - это параметр реквизита "Номер", "&Организация.Наименование%1" - это прараметр составного реквизита.
3. Пример заполнения табличной части: &НаборОборудования[Оборудование,Оборудование.ИнвентарныйНомер,ИнвентарныйНомер]%1

# Пример заполнения ТЧ через отдельную функцию

Данные табличной части можно реализовать в отдельной функции, например в модуле менеджера "ИсточникСсылка" и добавить к тексту:

// Дополнение данными ТЧ +
#Область ПодстановкаЗнчПараметновИзТЧ
	СодержимоеПисьма = СодержимоеПисьма + 
	МенеджерОбк.ПредставлениеТЧДляРассылкиУведомления(ИсточникСсылка);
	
#Область ПримерРеализации_ПредставлениеТЧДляРассылкиУведомления
	
// Функция - Представление ТЧДля рассылки уведомления
// 
// Параметры:
//  ИсточникСсылка - Ссылка на выбираемый объект
//
// Возвращаемое значение:
//  Строка - ТЧ объекта в строку для отправки уведомления на почту
//
Функция ПредставлениеТЧДляРассылкиУведомления(ИсточникСсылка) Экспорт
	
	ТЧСтр = "";
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	ПередачаОборудованияНаборОборудования.НомерСтроки КАК НомерСтроки,
		|	ПередачаОборудованияНаборОборудования.Оборудование КАК Оборудование,
		|	ПередачаОборудованияНаборОборудования.Оборудование.ИнвентарныйНомер КАК ИнвентарныйНомер,
		|	ПередачаОборудованияНаборОборудования.Оборудование.ИнвентарныйНомерБух КАК ИнвентарныйНомерБух,
		|	ПередачаОборудованияНаборОборудования.ВидОперации КАК ВидОперации,
		|	ПередачаОборудованияНаборОборудования.Оборудование.Комментарий КАК Комментарий		
		|ИЗ
		|	Документ.ПередачаОборудования.НаборОборудования КАК ПередачаОборудованияНаборОборудования
		|ГДЕ
		|	ПередачаОборудованияНаборОборудования.Ссылка = &ИсточникСсылка";
	
	Запрос.УстановитьПараметр("ИсточникСсылка", ИсточникСсылка);
	
	РезультатЗапроса = Запрос.Выполнить();
	
	ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
	
	Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
		ТЧСтр = 
		ТЧСтр 
		+ Символы.ПС
		+ ВыборкаДетальныеЗаписи.НомерСтроки
		+ ") "
		+ ВыборкаДетальныеЗаписи.Оборудование
		+ ",   Инвентарный номер: "
		+ ВыборкаДетальныеЗаписи.ИнвентарныйНомер
		+ ",   Инвентарный номер по бух: "
		+ ВыборкаДетальныеЗаписи.ИнвентарныйНомерБух
		+ ",   Вид операции: "
		+ ВыборкаДетальныеЗаписи.ВидОперации
		+ ",   Комментарий: "
		+ ВыборкаДетальныеЗаписи.Комментарий
		+ Символы.ПС;
	КонецЦикла;
	
	Возврат ТЧСтр;
	
КонецФункции

#КонецОбласти

#КонецОбласти
// Дополнение данными ТЧ ---
